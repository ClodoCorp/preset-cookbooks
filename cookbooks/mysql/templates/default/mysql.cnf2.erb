# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
# The MySQL database server configuration file.

[mysqld]
# * IMPORTANT
#   If you make changes to these settings and your system uses apparmor, you may
#   also need to also adjust /etc/apparmor.d/usr.sbin.mysqld.

#innodb_force_recovery 	= 4

character-set-server	= <%= @character_set_server %>
default-storage-engine	= <%= @default_storage_engine %>

# * Security Features
# Read the manual, too, if you want chroot!
# chroot = /var/lib/mysql/

# ssl-ca		= <%= @ssl_ca %>
# ssl-cert		= <%= @ssl_cert %>
# ssl-key		= <%= @ssl_key %>

datadir			= <%= @data_dir %>
bind-address            = <%= @bind_address %>
port			= <%= @port %>
user			= <%= @user %>
pid-file		= <%= @pid_file %>
socket			= <%= @socket %>

symbolic-links		= <%= @symbolic_links %>
basedir			= /usr
tmpdir			= /tmp

skip-external-locking
skip-name-resolve
#skip-federated

# Replica:
slave-skip-errors	= <%= @slave_skip_errors %>
log-bin                 = <%= @log_bin %>
server-id               = <%= @server_id %>
sync_binlog             = <%= @sync_binlog %>
expire_logs_days        = <%= @expire_logs_days %>
max_binlog_size         = <%= @max_binlog_size %>

relay_log_space_limit	= <%= @relay_log_space_limit %>
auto_increment_increment= <%= @auto_increment_increment %>
auto_increment_offset	= <%= @auto_increment_offset %>

# Per connection:
join_buffer_size        = <%= @join_buffer_size %>
read_rnd_buffer_size    = <%= @read_rnd_buffer_size %>
read_buffer_size        = <%= @read_buffer_size %>
sort_buffer_size        = <%= @sort_buffer_size %>
slave_net_timeout       = <%= @slave_net_timeout %>

# Global:
key_buffer_size         = <%= @key_buffer_size %>
concurrent_insert       = <%= @concurrent_insert %>
query_cache_limit       = <%= @query_cache_limit %>
query_cache_size        = <%= @query_cache_size %>
query_cache_type        = <%= @query_cache_type %>
table_open_cache        = <%= @table_open_cache %>
table_definition_cache	= <%= @table_definition_cache %>
thread_stack            = <%= @thread_stack %>
thread_cache_size       = <%= @thread_cache_size %>
max_connections         = <%= @max_connections %>
max_allowed_packet	= <%= @max_allowed_packet %>
max_heap_table_size	= <%= @max_heap_table_size %>
tmp_table_size		= <%= @tmp_table_size %>
myisam_sort_buffer_size	= <%= @myisam_sort_buffer_size %>

net_read_timeout	= <%= @net_read_timeout %>
net_write_timeout	= <%= @net_write_timeout %>
back_log		= <%= @back_log %>
wait_timeout		= <%= @wait_timeout %>


#log-queries-not-using-indexes
#log-slave-updates
long_query_time		= 2
slow_query_log		= 0
slow_query_log_file	= <%= @slow_query_log_file %>
#log-queries-not-using-indexes
#skip-locking

# InnoDB
#innodb_data_file_path		= <%= @innodb_data_file_path %>
innodb_log_file_size            = <%= @innodb_log_file_size %>
innodb_log_buffer_size          = <%= @innodb_log_buffer_size %>
innodb_buffer_pool_size         = <%= @innodb_buffer_pool_size %>
innodb_additional_mem_pool_size = <%= @innodb_additional_mem_pool_size %>
innodb_thread_concurrency       = <%= @innodb_thread_concurrency %>
innodb_flush_log_at_trx_commit  = <%= @innodb_flush_log_at_trx_commit %>
#innodb_flush_method            = <%= @innodb_flush_method %>		#O_DSYNC
#innodb_autoinc_lock_mode       = <%= @innodb_autoinc_lock_mode %>		#1
#innodb_autoinc_lock_mode       = <%= @innodb_autoinc_lock_mode %>		#2 incompatible with replication. (default 1)
#innodb_concurrency_tickets     = <%= @innodb_concurrency_tickets %>		#500 (default 500)
#innodb_commit_concurrency      = <%= @innodb_commit_concurrency %>		#10  (default unlimited, maximum 100)
innodb_lock_wait_timeout        = <%= @innodb_lock_wait_timeout %>
innodb_open_files               = <%= @innodb_open_files %>
innodb_file_per_table

[mysqld_safe]
log-error	= <%= @mysqld_safe_log_error %>
#socket		= <%= @mysqld_safe_socket %>
#nice		= 0

[mysqldump]
quick
quote-names
max_allowed_packet	= <%= @mysqldump_max_allowed_packet %>

[myisamchk]
key_buffer_size		= <%= @myisamchk_key_buffer_size %>
sort_buffer_size	= <%= @myisamchk_sort_buffer_size %>
read_buffer		= <%= @myisamchk_read_buffer %>
write_buffer		= <%= @myisamchk_write_buffer %>

[mysqlhotcopy]
interactive-timeout

[mysql]
no-auto-rehash # faster start of mysql but no tab completition

# * IMPORTANT: Additional settings that can override those from this file!
#   The files must end with '.cnf', otherwise they'll be ignored.
!includedir /etc/mysql/conf.d/

